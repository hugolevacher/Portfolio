<div class="popup-backdrop" (click)="onBackdropClick($event)">
    <div class="popup-container">
        <div class="popup-header">
            <h2>Edit Project</h2>
            <button class="close-btn" (click)="closePopup()">&times;</button>
        </div>

        <div class="popup-content">
            <form (ngSubmit)="onSubmit()" #projectForm="ngForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="order">Order</label>
                        <input type="number" id="order" name="order" [(ngModel)]="order" [disabled]="!isLoggedIn"
                            min="1" max="999">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="titleFr">Title (French)</label>
                        <input type="text" id="titleFr" name="titleFr" [(ngModel)]="titleFr" [disabled]="!isLoggedIn"
                            maxlength="100">
                    </div>
                    <div class="form-group">
                        <label for="titleEn">Title (English)</label>
                        <input type="text" id="titleEn" name="titleEn" [(ngModel)]="titleEn" [disabled]="!isLoggedIn"
                            maxlength="100">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="descriptionFr">Description (French)</label>
                        <textarea id="descriptionFr" name="descriptionFr" [(ngModel)]="descriptionFr"
                            [disabled]="!isLoggedIn" rows="3" maxlength="255"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="descriptionEn">Description (English)</label>
                        <textarea id="descriptionEn" name="descriptionEn" [(ngModel)]="descriptionEn"
                            [disabled]="!isLoggedIn" rows="3" maxlength="255"></textarea>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="textFr">Text (French)</label>
                        <textarea id="textFr" name="textFr" [(ngModel)]="textFr" [disabled]="!isLoggedIn"
                            rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="textEn">Text (English)</label>
                        <textarea id="textEn" name="textEn" [(ngModel)]="textEn" [disabled]="!isLoggedIn"
                            rows="4"></textarea>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="projectUrl">Project URL</label>
                        <input type="url" id="projectUrl" name="projectUrl" [(ngModel)]="projectUrl"
                            [disabled]="!isLoggedIn" placeholder="https://...">
                    </div>
                    <div class="form-group">
                        <label for="githubUrl">GitHub URL</label>
                        <input type="url" id="githubUrl" name="githubUrl" [(ngModel)]="githubUrl"
                            [disabled]="!isLoggedIn" placeholder="https://github.com/...">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="image">New Image (optional)</label>
                        <input type="file" id="image" name="image" (change)="onImageSelected($event)"
                            [disabled]="!isLoggedIn" accept="image/*">
                        <small *ngIf="selectedImage">Selected: {{ selectedImage.name }}</small>
                        <small *ngIf="!selectedImage && project?.image">Current: {{ project.image }}</small>
                    </div>
                    <div class="form-group">
                        <label for="video">New Video (optional)</label>
                        <input type="file" id="video" name="video" (change)="onVideoSelected($event)"
                            [disabled]="!isLoggedIn" accept="video/*">
                        <small *ngIf="selectedVideo">Selected: {{ selectedVideo.name }}</small>
                        <small *ngIf="!selectedVideo && project?.video">Current: {{ project.video }}</small>
                    </div>
                </div>

                <div *ngIf="!isLoggedIn" class="login-warning">
                    <p>⚠️ You must be logged in to edit projects.</p>
                </div>

                <div *ngIf="error" class="error-message">{{ error }}</div>
                <div *ngIf="success" class="success-message">{{ success }}</div>

                <div class="form-actions">
                    <button type="button" (click)="closePopup()" class="btn-cancel">Cancel</button>
                    <button type="submit" [disabled]="!isLoggedIn || isSubmitting" class="btn-submit">
                        {{ isSubmitting ? 'Updating...' : 'Update Project' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>